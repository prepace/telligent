"use client";

import type React from "react";

import { useState, useEffect, useId } from "react";
import { useParams, useRouter } from "next/navigation";
import Link from "next/link";

// Mock article data
const MOCK_ARTICLE = {
	id: "1",
	title: "Breaking News: Tech Innovation",
	content:
		"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam euismod, nisl eget aliquam ultricies, nunc nisl aliquet nunc, quis aliquam nisl nunc quis nisl. Nullam euismod, nisl eget aliquam ultricies, nunc nisl aliquet nunc, quis aliquam nisl nunc quis nisl.",
	category: "Technology",
	author: "John Doe",
	status: "Published",
	date: "2023-03-15",
	tags: "tech, innovation, news",
	featuredImage: "https://via.placeholder.com/800x400",
	excerpt:
		"A groundbreaking tech innovation has been announced today that could change the industry.",
};

export default function EditArticlePage() {
	const params = useParams();
	const router = useRouter();
	const [formData, setFormData] = useState({
		title: "",
		content: "",
		category: "",
		tags: "",
		featuredImage: "",
		excerpt: "",
		status: "draft",
	});
	const [isSubmitting, setIsSubmitting] = useState(false);
	const [loading, setLoading] = useState(true);
	const titleInputId = useId();

	useEffect(() => {
		// In a real app, you would fetch the article data from an API
		// For now, we'll use mock data
		setFormData({
			title: MOCK_ARTICLE.title,
			content: MOCK_ARTICLE.content,
			category: MOCK_ARTICLE.category,
			tags: MOCK_ARTICLE.tags,
			featuredImage: MOCK_ARTICLE.featuredImage,
			excerpt: MOCK_ARTICLE.excerpt,
			status: MOCK_ARTICLE.status.toLowerCase(),
		});
		setLoading(false);
	}, []);

	const handleChange = (
		e: React.ChangeEvent<
			HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement
		>,
	) => {
		const { name, value } = e.target;
		setFormData((prev) => ({
			...prev,
			[name]: value,
		}));
	};

	const handleSubmit = async (e: React.FormEvent) => {
		e.preventDefault();
		setIsSubmitting(true);

		try {
			// In a real app, you would make an API call here
			console.log("Updating article:", params.id, formData);

			// Simulate API call
			await new Promise((resolve) => setTimeout(resolve, 1000));

			// Redirect to article detail
			router.push(`/admin/articles/${params.id}`);
		} catch (error) {
			console.error("Error updating article:", error);
		} finally {
			setIsSubmitting(false);
		}
	};

	if (loading) {
		return (
			<div className="flex justify-center items-center h-64">
				<div className="text-lg">Loading...</div>
			</div>
		);
	}

	return (
		<div className="space-y-6">
			<div className="flex justify-between items-center">
				<h1 className="text-2xl font-bold">Edit Article</h1>
				<Link
					href={`/admin/articles/${params.id}`}
					className="px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 transition-colors"
				>
					Cancel
				</Link>
			</div>

			<div className="bg-white p-6 rounded-lg shadow">
				<form onSubmit={handleSubmit} className="space-y-6">
					<div className="grid grid-cols-1 gap-6 md:grid-cols-2">
						<div className="space-y-2">
							<label
								htmlFor={titleInputId}
								className="block text-sm font-medium text-gray-700"
							>
								Title <span className="text-red-500">*</span>
							</label>
							<input
								type="text"
								id={titleInputId}
								name="title"
								required
								className="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
								value={formData.title}
								onChange={handleChange}
							/>
						</div>

						<div className="space-y-2">
							<label
								htmlFor={`${titleInputId}-category`}
								className="block text-sm font-medium text-gray-700"
							>
								Category <span className="text-red-500">*</span>
							</label>
							<select
								id={`${titleInputId}-category`}
								name="category"
								required
								className="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
								value={formData.category}
								onChange={handleChange}
							>
								<option value="">Select a category</option>
								<option value="Technology">Technology</option>
								<option value="Sports">Sports</option>
								<option value="Finance">Finance</option>
								<option value="Entertainment">Entertainment</option>
								<option value="Health">Health</option>
							</select>
						</div>
					</div>

					<div className="space-y-2">
						<label
							htmlFor={`${titleInputId}-excerpt`}
							className="block text-sm font-medium text-gray-700"
						>
							Excerpt
						</label>
						<textarea
							id={`${titleInputId}-excerpt`}
							name="excerpt"
							rows={2}
							className="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
							value={formData.excerpt}
							onChange={handleChange}
							placeholder="A brief summary of the article"
						/>
					</div>

					<div className="space-y-2">
						<label
							htmlFor={`${titleInputId}-content`}
							className="block text-sm font-medium text-gray-700"
						>
							Content <span className="text-red-500">*</span>
						</label>
						<textarea
							id={`${titleInputId}-content`}
							name="content"
							rows={10}
							required
							className="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
							value={formData.content}
							onChange={handleChange}
						/>
					</div>

					<div className="grid grid-cols-1 gap-6 md:grid-cols-2">
						<div className="space-y-2">
							<label
								htmlFor={`${titleInputId}-featuredImage`}
								className="block text-sm font-medium text-gray-700"
							>
								Featured Image URL
							</label>
							<input
								type="text"
								id={`${titleInputId}-featuredImage`}
								name="featuredImage"
								className="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
								value={formData.featuredImage}
								onChange={handleChange}
								placeholder="https://example.com/image.jpg"
							/>
						</div>

						<div className="space-y-2">
							<label
								htmlFor={`${titleInputId}-tags`}
								className="block text-sm font-medium text-gray-700"
							>
								Tags
							</label>
							<input
								type="text"
								id={`${titleInputId}-tags`}
								name="tags"
								className="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
								value={formData.tags}
								onChange={handleChange}
								placeholder="Separate tags with commas"
							/>
						</div>
					</div>

					<div className="space-y-2">
						<label
							htmlFor="status"
							className="block text-sm font-medium text-gray-700"
						>
							Status
						</label>
						<div className="flex space-x-4">
							<label className="inline-flex items-center">
								<input
									type="radio"
									name="status"
									value="draft"
									checked={formData.status === "draft"}
									onChange={handleChange}
									className="h-4 w-4 text-blue-600 focus:ring-blue-500"
								/>
								<span className="ml-2">Draft</span>
							</label>
							<label className="inline-flex items-center">
								<input
									type="radio"
									name="status"
									value="published"
									checked={formData.status === "published"}
									onChange={handleChange}
									className="h-4 w-4 text-blue-600 focus:ring-blue-500"
								/>
								<span className="ml-2">Published</span>
							</label>
						</div>
					</div>

					<div className="flex justify-end space-x-4">
						<Link
							href={`/admin/articles/${params.id}`}
							className="px-6 py-2 border border-gray-300 rounded hover:bg-gray-100 transition-colors"
						>
							Cancel
						</Link>
						<button
							type="submit"
							disabled={isSubmitting}
							className="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors disabled:opacity-50"
						>
							{isSubmitting ? "Saving..." : "Update Article"}
						</button>
					</div>
				</form>
			</div>
		</div>
	);
}
